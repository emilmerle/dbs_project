-- Creating tables (with schemas)
-- creating table life_expectancy (without foreign keys)
CREATE TABLE life_expectancy ( 
    country_name VARCHAR(100), 
    country_code CHAR(3) PRIMARY KEY,
    "1960" REAL, "1961" REAL, "1962" REAL, "1963" REAL, "1964" REAL, "1965" REAL,
    "1966" REAL, "1967" REAL, "1968" REAL, "1969" REAL, "1970" REAL,
    "1971" REAL, "1972" REAL, "1973" REAL, "1974" REAL, "1975" REAL,
    "1976" REAL, "1977" REAL, "1978" REAL, "1979" REAL, "1980" REAL,
    "1981" REAL, "1982" REAL, "1983" REAL, "1984" REAL, "1985" REAL,
    "1986" REAL, "1987" REAL, "1988" REAL, "1989" REAL, "1990" REAL,
    "1991" REAL, "1992" REAL, "1993" REAL, "1994" REAL, "1995" REAL,
    "1996" REAL, "1997" REAL, "1998" REAL, "1999" REAL, "2000" REAL,
    "2001" REAL, "2002" REAL, "2003" REAL, "2004" REAL, "2005" REAL,
    "2006" REAL, "2007" REAL, "2008" REAL, "2009" REAL, "2010" REAL,
    "2011" REAL, "2012" REAL, "2013" REAL, "2014" REAL, "2015" REAL, "2016" REAL
);

-- creating table life_expectancy (without foreign keys)
CREATE TABLE gdp ( 
    country_name VARCHAR(100), 
    country_code CHAR(3) PRIMARY KEY,
    "1960" BIGINT, "1961" BIGINT, "1962" BIGINT, "1963" BIGINT, "1964" BIGINT, "1965" BIGINT,
    "1966" BIGINT, "1967" BIGINT, "1968" BIGINT, "1969" BIGINT, "1970" BIGINT,
    "1971" BIGINT, "1972" BIGINT, "1973" BIGINT, "1974" BIGINT, "1975" BIGINT,
    "1976" BIGINT, "1977" BIGINT, "1978" BIGINT, "1979" BIGINT, "1980" BIGINT,
    "1981" BIGINT, "1982" BIGINT, "1983" BIGINT, "1984" BIGINT, "1985" BIGINT,
    "1986" BIGINT, "1987" BIGINT, "1988" BIGINT, "1989" BIGINT, "1990" BIGINT,
    "1991" BIGINT, "1992" BIGINT, "1993" BIGINT, "1994" BIGINT, "1995" BIGINT,
    "1996" BIGINT, "1997" BIGINT, "1998" BIGINT, "1999" BIGINT, "2000" BIGINT,
    "2001" BIGINT, "2002" BIGINT, "2003" BIGINT, "2004" BIGINT, "2005" BIGINT,
    "2006" BIGINT, "2007" BIGINT, "2008" BIGINT, "2009" BIGINT, "2010" BIGINT,
    "2011" BIGINT, "2012" BIGINT, "2013" BIGINT, "2014" BIGINT, "2015" BIGINT, "2016" BIGINT
);

-- creating table population_total
CREATE TABLE population_total ( 
    country_name VARCHAR(100) PRIMARY KEY, 
    "1960" BIGINT, "1961" BIGINT, "1962" BIGINT, "1963" BIGINT, "1964" BIGINT, "1965" BIGINT,
    "1966" BIGINT, "1967" BIGINT, "1968" BIGINT, "1969" BIGINT, "1970" BIGINT,
    "1971" BIGINT, "1972" BIGINT, "1973" BIGINT, "1974" BIGINT, "1975" BIGINT,
    "1976" BIGINT, "1977" BIGINT, "1978" BIGINT, "1979" BIGINT, "1980" BIGINT,
    "1981" BIGINT, "1982" BIGINT, "1983" BIGINT, "1984" BIGINT, "1985" BIGINT,
    "1986" BIGINT, "1987" BIGINT, "1988" BIGINT, "1989" BIGINT, "1990" BIGINT,
    "1991" BIGINT, "1992" BIGINT, "1993" BIGINT, "1994" BIGINT, "1995" BIGINT,
    "1996" BIGINT, "1997" BIGINT, "1998" BIGINT, "1999" BIGINT, "2000" BIGINT,
    "2001" BIGINT, "2002" BIGINT, "2003" BIGINT, "2004" BIGINT, "2005" BIGINT,
    "2006" BIGINT, "2007" BIGINT, "2008" BIGINT, "2009" BIGINT, "2010" BIGINT,
    "2011" BIGINT, "2012" BIGINT, "2013" BIGINT, "2014" BIGINT, "2015" BIGINT, "2016" BIGINT
);

-- creating table population_growth
CREATE TABLE population_growth ( 
    country_name VARCHAR(100), 
    country_code CHAR(3) PRIMARY KEY,
    "1960" REAL, "1961" REAL, "1962" REAL, "1963" REAL, "1964" REAL, "1965" REAL,
    "1966" REAL, "1967" REAL, "1968" REAL, "1969" REAL, "1970" REAL,
    "1971" REAL, "1972" REAL, "1973" REAL, "1974" REAL, "1975" REAL,
    "1976" REAL, "1977" REAL, "1978" REAL, "1979" REAL, "1980" REAL,
    "1981" REAL, "1982" REAL, "1983" REAL, "1984" REAL, "1985" REAL,
    "1986" REAL, "1987" REAL, "1988" REAL, "1989" REAL, "1990" REAL,
    "1991" REAL, "1992" REAL, "1993" REAL, "1994" REAL, "1995" REAL,
    "1996" REAL, "1997" REAL, "1998" REAL, "1999" REAL, "2000" REAL,
    "2001" REAL, "2002" REAL, "2003" REAL, "2004" REAL, "2005" REAL,
    "2006" REAL, "2007" REAL, "2008" REAL, "2009" REAL, "2010" REAL,
    "2011" REAL, "2012" REAL, "2013" REAL, "2014" REAL, "2015" REAL, "2016" REAL
);

-- creating table co2_emission
CREATE TABLE co2_emission ( 
    country_name VARCHAR(100), 
    country_code CHAR(3) PRIMARY KEY,
    "1960" BIGINT, "1961" BIGINT, "1962" BIGINT, "1963" BIGINT, "1964" BIGINT, "1965" BIGINT,
    "1966" BIGINT, "1967" BIGINT, "1968" BIGINT, "1969" BIGINT, "1970" BIGINT,
    "1971" BIGINT, "1972" BIGINT, "1973" BIGINT, "1974" BIGINT, "1975" BIGINT,
    "1976" BIGINT, "1977" BIGINT, "1978" BIGINT, "1979" BIGINT, "1980" BIGINT,
    "1981" BIGINT, "1982" BIGINT, "1983" BIGINT, "1984" BIGINT, "1985" BIGINT,
    "1986" BIGINT, "1987" BIGINT, "1988" BIGINT, "1989" BIGINT, "1990" BIGINT,
    "1991" BIGINT, "1992" BIGINT, "1993" BIGINT, "1994" BIGINT, "1995" BIGINT,
    "1996" BIGINT, "1997" BIGINT, "1998" BIGINT, "1999" BIGINT, "2000" BIGINT,
    "2001" BIGINT, "2002" BIGINT, "2003" BIGINT, "2004" BIGINT, "2005" BIGINT,
    "2006" BIGINT, "2007" BIGINT, "2008" BIGINT, "2009" BIGINT, "2010" BIGINT,
    "2011" BIGINT, "2012" BIGINT, "2013" BIGINT, "2014" BIGINT, "2015" BIGINT, "2016" BIGINT
);

-- adding the columns with the foreign keys that map to the primary keys of the other table(s)
ALTER TABLE life_expectancy 
ADD COLUMN gdp_country_code CHAR(3) REFERENCES gdp (country_code);

ALTER TABLE gdp 
ADD COLUMN life_expectancy_country_code CHAR(3) REFERENCES life_expectancy (country_code);



-- Importing data:
-- (by GUI in pgAdmin4)

-- importing the foreign keys too
UPDATE life_expectancy
SET gdp_country_code = gdp.country_code
FROM gdp
WHERE gdp.country_code = life_expectancy.country_code;

UPDATE gdp
SET life_expectancy_country_code = life_expectancy.country_code
FROM life_expectancy
WHERE life_expectancy.country_code = gdp.country_code;